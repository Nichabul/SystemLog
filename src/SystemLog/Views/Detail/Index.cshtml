@using System.Collections.Generic
@using Microsoft.AspNetCore.Http
@using Microsoft.AspNetCore.Http.Authentication
@model LoginViewModel
@inject SignInManager<ApplicationUser> SignInManager

@{
    ViewData["Title"] = "รายการการติดตามสถานะการดำเนินงาน";
    var Helper = ViewBag.Helper as SystemLog.Helper.Utility;
}

<h2 style="margin-top: 40px; text-align:center;">@ViewData["Title"]</h2>
<div class="row">
    <div class="col-md-12">
        <div class="well">
            <div style="text-align:center;">
                <label class="control-label col-md-2" >เดือน : </label>
                <select class="form-control col-md-4" id="Month">
                    @{
                        //int year = DateTime.DaysInMonth(DateTime.Now.DayOfYear,);
                        for (int i = 1; i < 13; i++)
                        {
                            <option value="@i">@Helper.getMonth(i)</option>
                        }
                       
                    }
                </select>
                <label class="control-label col-md-2">ปี : </label>
                <select class="form-control col-md-4" id="Year">
                    @{
                        for (int s = 2017; s <= 3001; s++)
                        {

                            <option value="@s">@s</option>
                        }
                    }
                </select>
                <button type="button" class="btn btn-warning" id="search">ค้นหา</button>
            </div>  
        </div>
        <div id="Viewreport"></div>
    </div>
</div>

@section Scripts {
    @{ await Html.RenderPartialAsync("_ValidationScriptsPartial"); }

    <script>
        $(function () {
            var month = $("#Month").val();
            var year = $("#Year").val();
            Getreports(month, year);
            $("#search").click(function () {
                var month = $("#Month").val();
                var year = $("#Year").val();
                Getreports(month, year);
            });
        });
        function Getreports(month, year) {
            $.get("/Detail/Getreport", {"month":month,"year":year}, function (callback) {
                $("#Viewreport").html(callback);
                //คลิกปุุ่ม จัดการไปยังหน้าจัดการรายการการติดตามสถานะการดำเนินงาน
                $(".manage").click(function () {
                    var date = $(this).val();
                    window.location.href = "/Detail/ManageDetails?date=" + date;

                });

                $(".review").click(function () {  
                    var date = $(this).val();
                    window.location.href = "/Detail/Reportdetail?date=" + date;

                })
            });
        }

        

    </script>
}
